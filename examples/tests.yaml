---
anta.tests.aaa:
  - VerifyTacacsSourceIntf:
      intf: Management0
      vrf: default
  - VerifyTacacsServers:
      servers:
        - 1.1.1.1
        - 2.2.2.2
      vrf: default
  - VerifyTacacsServerGroups:
      groups:
        - admin
        - user
  - VerifyAuthenMethods:
      methods:
        - local
        - none
        - logging
      types:
        - login
        - enable
        - dot1x
  - VerifyAuthzMethods:
      methods:
        - local
        - none
        - logging
      types:
        - commands
        - exec
  - VerifyAcctDefaultMethods:
      methods:
        - local
        - none
        - logging
      types:
        - system
        - exec
        - commands
        - dot1x
  - VerifyAcctConsoleMethods:
      methods:
        - local
        - none
        - logging
      types:
        - system
        - exec
        - commands
        - dot1x

anta.tests.bfd:
  - VerifyBFDSpecificPeers:
      bfd_peers:
        - peer_address: 192.0.255.8
          vrf: default
        - peer_address: 192.0.255.7
          vrf: default
  - VerifyBFDPeersIntervals:
      bfd_peers:
        - peer_address: 192.0.255.8
          vrf: default
          tx_interval: 1200
          rx_interval: 1200
          multiplier: 3
        - peer_address: 192.0.255.7
          vrf: default
          tx_interval: 1200
          rx_interval: 1200
          multiplier: 3

anta.tests.configuration:
  - VerifyZeroTouch:
  - VerifyRunningConfigDiffs:

anta.tests.connectivity:
  - VerifyReachability:
      hosts:
        - source: Management0
          destination: 1.1.1.1
          vrf: MGMT
        - source: Management0
          destination: 8.8.8.8
          vrf: MGMT
  - VerifyLLDPNeighbors:
      neighbors:
        - port: Ethernet1
          neighbor_device: DC1-SPINE1
          neighbor_port: Ethernet1
        - port: Ethernet2
          neighbor_device: DC1-SPINE2
          neighbor_port: Ethernet1

anta.tests.field_notices:
  - VerifyFieldNotice44Resolution:
  - VerifyFieldNotice72Resolution:

anta.tests.hardware:
  - VerifyTransceiversManufacturers:
      manufacturers:
        - Not Present
        - Arista Networks
        - Arastra, Inc.
  - VerifyTemperature:
  - VerifyTransceiversTemperature:
  - VerifyEnvironmentSystemCooling:
  - VerifyEnvironmentCooling:
      states:
        - ok
  - VerifyEnvironmentPower:
      states:
        - ok
  - VerifyAdverseDrops:

anta.tests.interfaces:
  - VerifyInterfaceUtilization:
  - VerifyInterfaceErrors:
  - VerifyInterfaceDiscards:
  - VerifyInterfaceErrDisabled:
  - VerifyInterfacesStatus:
      interfaces:
        - interface: Ethernet1
          state: up
        - interface: Ethernet2
          state: up
          protocol_status: up
        - interface: Vlan10
          state: adminDown
          protocol_status: down
  - VerifyStormControlDrops:
  - VerifyPortChannels:
  - VerifyIllegalLACP:
  - VerifyLoopbackCount:
      number: 3
  - VerifySVI:
  - VerifyL3MTU:
      mtu: 1500
      ignored_interfaces:
          - Vxlan1
      specific_mtu:
          - Ethernet1: 2500
  - VerifyIPProxyARP:
      interfaces:
        - Ethernet1
        - Ethernet2
  - VerifyL2MTU:
      mtu: 1500
      ignored_interfaces:
        - Management1
        - Vxlan1
      specific_mtu:
        - Ethernet1/1: 1500

anta.tests.logging:
  - VerifyLoggingPersistent:
  - VerifyLoggingSourceIntf:
      interface: Management0
      vrf: default
  - VerifyLoggingHosts:
      hosts:
        - 1.1.1.1
        - 2.2.2.2
      vrf: default
  - VerifyLoggingLogsGeneration:
  - VerifyLoggingHostname:
  - VerifyLoggingTimestamp:
  - VerifyLoggingAccounting:
  - VerifyLoggingErrors:

anta.tests.mlag:
  - VerifyMlagStatus:
  - VerifyMlagInterfaces:
  - VerifyMlagConfigSanity:
  - VerifyMlagReloadDelay:
      reload_delay: 300
      reload_delay_non_mlag: 330
  - VerifyMlagDualPrimary:
      detection_delay: 200
      errdisabled: True
      recovery_delay: 60
      recovery_delay_non_mlag: 0
  - VerifyMlagPrimaryPriority:
      primary_priority: 3276

anta.tests.multicast:
  - VerifyIGMPSnoopingVlans:
      vlans:
        10: False
        12: False
  - VerifyIGMPSnoopingGlobal:
      enabled: True

anta.tests.profiles:
  - VerifyUnifiedForwardingTableMode:
      mode: 3
  - VerifyTcamProfile:
      profile: vxlan-routing

anta.tests.security:
  - VerifySSHStatus:
  - VerifySSHIPv4Acl:
      number: 3
      vrf: default
  - VerifySSHIPv6Acl:
      number: 3
      vrf: default
  - VerifyTelnetStatus:
  - VerifyAPIHttpStatus:
  - VerifyAPIHttpsSSL:
      profile: default
  - VerifyAPIIPv4Acl:
      number: 3
      vrf: default
  - VerifyAPIIPv6Acl:
      number: 3
      vrf: default
  - VerifyAPISSLCertificate:
      certificates:
        - certificate_name: ARISTA_SIGNING_CA.crt
          expiry_threshold: 30
          common_name: AristaIT-ICA ECDSA Issuing Cert Authority
          encryption_algorithm: ECDSA
          key_size: 256
        - certificate_name: ARISTA_ROOT_CA.crt
          expiry_threshold: 30
          common_name: Arista Networks Internal IT Root Cert Authority
          encryption_algorithm: RSA
          key_size: 4096

anta.tests.services:
  - VerifyBannerLogin:
        login_banner: |
            # Copyright (c) 2023-2024 Arista Networks, Inc.
            # Use of this source code is governed by the Apache License 2.0
            # that can be found in the LICENSE file.
  - VerifyBannerMotd:
        motd_banner: |
            # Copyright (c) 2023-2024 Arista Networks, Inc.
            # Use of this source code is governed by the Apache License 2.0
            # that can be found in the LICENSE file.
  - VerifyHostname:
      hostname: s1-spine1

anta.tests.snmp:
  - VerifySnmpStatus:
      vrf: default
  - VerifySnmpIPv4Acl:
      number: 3
      vrf: default
  - VerifySnmpIPv6Acl:
      number: 3
      vrf: default
  - VerifySnmpLocation:
      location: New York
  - VerifySnmpContact:
      contact: Jon@example.com

anta.tests.software:
  - VerifyEOSVersion:
      versions:
        - 4.25.4M
        - 4.26.1F
  - VerifyTerminAttrVersion:
      versions:
        - v1.13.6
        - v1.8.0
  - VerifyEOSExtensions:

anta.tests.stp:
  - VerifySTPMode:
      mode: rapidPvst
      vlans:
        - 10
        - 20
  - VerifySTPBlockedPorts:
  - VerifySTPCounters:
  - VerifySTPForwardingPorts:
      vlans:
        - 10
        - 20
  - VerifySTPRootPriority:
      priority: 32768
      instances:
        - 10
        - 20

anta.tests.system:
  - VerifyUptime:
      minimum: 86400
  - VerifyReloadCause:
  - VerifyCoredump:
  - VerifyAgentLogs:
  - VerifyCPUUtilization:
  - VerifyMemoryUtilization:
  - VerifyFileSystemUtilization:
  - VerifyNTP:

anta.tests.vxlan:
  - VerifyVxlan1Interface:
  - VerifyVxlanConfigSanity:
  - VerifyVxlanVniBinding:
      bindings:
        10010: 10
        10020: 20
  - VerifyVxlanVtep:
      vteps:
        - 10.1.1.5
        - 10.1.1.6

anta.tests.routing:
  generic:
    - VerifyRoutingProtocolModel:
        model: multi-agent
    - VerifyRoutingTableSize:
        minimum: 2
        maximum: 20
    - VerifyBFD:
    - VerifyRoutingTableEntry:
        vrf: default
        routes:
          - 10.1.0.1
          - 10.1.0.2
  bgp:
    - VerifyBGPPeerCount:
        address_families:
          - afi: "evpn"
            num_peers: 2
          - afi: "ipv4"
            safi: "unicast"
            vrf: "PROD"
            num_peers: 2
          - afi: "ipv4"
            safi: "unicast"
            vrf: "default"
            num_peers: 3
          - afi: "ipv4"
            safi: "multicast"
            vrf: "DEV"
            num_peers: 3
    - VerifyBGPPeersHealth:
        address_families:
          - afi: "evpn"
          - afi: "ipv4"
            safi: "unicast"
            vrf: "default"
          - afi: "ipv6"
            safi: "unicast"
            vrf: "DEV"
    - VerifyBGPSpecificPeers:
        address_families:
          - afi: "evpn"
            peers:
              - 10.1.0.1
              - 10.1.0.2
          - afi: "ipv4"
            safi: "unicast"
            peers:
              - 10.1.254.1
              - 10.1.255.0
              - 10.1.255.2
              - 10.1.255.4
    - VerifyBGPExchangedRoutes:
        bgp_peers:
          - peer_address: 172.30.255.5
            vrf: default
            advertised_routes:
              - 192.0.254.5/32
            received_routes:
              - 192.0.255.4/32
          - peer_address: 172.30.255.1
            vrf: default
            advertised_routes:
              - 192.0.255.1/32
              - 192.0.254.5/32
            received_routes:
              - 192.0.254.3/32
    - VerifyBGPPeerMPCaps:
        bgp_peers:
          - peer_address: 172.30.11.1
            vrf: default
            capabilities:
              - ipv4Unicast
    - VerifyBGPPeerASNCap:
        bgp_peers:
          - peer_address: 172.30.11.1
            vrf: default
    - VerifyBGPPeerRouteRefreshCap:
        bgp_peers:
          - peer_address: 172.30.11.1
            vrf: default
    - VerifyBGPPeerMD5Auth:
        bgp_peers:
          - peer_address: 172.30.11.1
            vrf: default
          - peer_address: 172.30.11.5
            vrf: default
    - VerifyEVPNType2Route:
        vxlan_endpoints:
          - address: 192.168.20.102
            vni: 10020
          - address: aac1.ab5d.b41e
            vni: 10010
  ospf:
    - VerifyOSPFNeighborState:
    - VerifyOSPFNeighborCount:
        number: 3
